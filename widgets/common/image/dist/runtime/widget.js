define(["jimu-core","jimu-ui"],(function(t,e){return function(t){var e={};function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="",o(o.s=380)}({0:function(e,o){e.exports=t},1:function(t,o){t.exports=e},13:function(t,e){t.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M9.521 5.47L3.981.162a.592.592 0 00-.813 0 .534.534 0 000 .779L8.448 6l-5.28 5.06a.534.534 0 000 .779.592.592 0 00.813 0l5.54-5.31a.726.726 0 000-1.058z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},16:function(t,e){t.exports='<svg viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M2.479 5.47L8.019.162a.592.592 0 01.813 0 .534.534 0 010 .779L3.552 6l5.28 5.06a.534.534 0 010 .779.592.592 0 01-.813 0l-5.54-5.31a.726.726 0 010-1.058z" fill="#000"></path><path d="M0 0h12v12H0z"></path></g></svg>'},33:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.ByUpload="BYUPLOAD",t.ByStaticUrl="BYSTATICURL",t.ByDynamicUrl="BYDYNAMICURL"}(e.ImgSourceType||(e.ImgSourceType={})),function(t){t.Expression="EXPRESSION",t.Attachment="ATTACHMENT",t.Symbol="SYMBOL"}(e.DynamicUrlType||(e.DynamicUrlType={}))},380:function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),s=this&&this.__makeTemplateObject||function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};Object.defineProperty(e,"__esModule",{value:!0});var r,a=o(0),p=o(1),c=o(33),u=o(381),l=o(382),g=o(383),f=o(384),h={},d=function(t){function e(e){var o=t.call(this,e)||this;o.__unmount=!1,o.attachmentTypes=["image/png","image/jpeg","image/gif","image/bmp","image/svg+xml"],o.isAutoHeight=!1,o.checkIsStaticSrc=function(t){return t===c.ImgSourceType.ByUpload||t===c.ImgSourceType.ByStaticUrl||!t},o.getSrcExpression=function(){return o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.srcExpression||a.Immutable({name:"",parts:[{type:a.ExpressionPartType.String,exp:'"'+(o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.imageParam&&o.props.config.functionConfig.imageParam.url)+'"'}]})},o.getAltTextExpression=function(){return o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.altTextExpression||a.Immutable({name:"",parts:[{type:a.ExpressionPartType.String,exp:'"'+(o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.altText)+'"'}]})},o.getToolTipExpression=function(){return o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.toolTipExpression||a.Immutable({name:"",parts:[{type:a.ExpressionPartType.String,exp:'"'+(o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.toolTip)+'"'}]})},o.getLinkUrlExpression=function(){return o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.linkParam&&o.props.config.functionConfig.linkParam&&o.props.config.functionConfig.linkParam.expression||null},o.onSrcExpResolveChange=function(t){if(t.isSuccessful)o.setState({src:"null"===t.value?"":t.value});else{var e="";t.value===a.ExpressionResolverErrorCode.Failed&&(e=o.state.srcExpression&&o.state.srcExpression.name),o.setState({src:e})}},o.onToolTipExpResolveChange=function(t){if(t.isSuccessful)o.setState({toolTip:"null"===t.value?"":t.value});else{var e="";t.value===a.ExpressionResolverErrorCode.Failed&&(e=o.state.srcExpression&&o.state.srcExpression.name),o.setState({toolTip:e})}},o.onAltTextExpResolveChange=function(t){if(t.isSuccessful)o.setState({altText:"null"===t.value?"":t.value});else{var e="";t.value===a.ExpressionResolverErrorCode.Failed&&(e=o.state.srcExpression&&o.state.srcExpression.name),o.setState({altText:e})}},o.onLinkUrlExpResolveChange=function(t){if(t.isSuccessful)o.setState({linkUrl:t.value});else{var e="";t.value===a.ExpressionResolverErrorCode.Failed&&(e=o.state.srcExpression&&o.state.srcExpression.name),o.setState({linkUrl:e})}},o.onAttachmentInfosChange=function(t){o.setState({attachmentInfos:t})},o.onSymbolElementChange=function(t){o.setState({symbolElement:t})},o.getRecordsFromRepeatedDataSource=function(){var t,e=o.props.useDataSources&&o.props.useDataSources[0]&&o.props.useDataSources[0].dataSourceId;if(e&&o.props.repeatedDataSource&&e===o.props.repeatedDataSource.dataSourceId){var n=o.props.repeatedDataSource.record;return(t={})[e]=n,t}return null},o.onClick=function(t){var e=o.props.config.functionConfig.linkParam;e&&e.value&&e.linkType!==a.LinkType.None&&(t.exbEventType="linkClick")},o.handleImageLoaded=function(t,e){o.setState({imageWidth:t,imageHeight:e})},o.getWidgetWidth=function(){return o.state.widgetWidth},o.getWidgetHeight=function(){return o.state.widgetHeight},o.onResize=function(t,e){o.__unmount||(t||e)&&(t===o.state.widgetWidth&&e===o.state.widgetHeight||(h[o.props.id+"-"+o.props.layoutId]={width:t,height:e},o.setState({widgetWidth:t,widgetHeight:e})))},o.handleRecordChange=function(t){o.setState({record:t})};var n=navigator.userAgent.toLowerCase();return-1===n.indexOf("chrom")&&-1===n.indexOf("firefox")&&n.indexOf("safari")>-1&&(o.isAutoHeight=!0),o.debounceOnResize=a.lodash.debounce((function(t,e){return o.onResize(t,e)}),200),o.state={record:null,toolTip:o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.toolTip||"",altText:o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.altText||"",src:o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.imageParam&&o.props.config.functionConfig.imageParam.url||"",linkUrl:o.props.config&&o.props.config.functionConfig&&o.props.config.functionConfig.linkParam&&o.props.config.functionConfig.linkParam.value||"",srcExpression:o.props.useDataSourcesEnabled&&o.getSrcExpression(),altTextExpression:o.props.useDataSourcesEnabled&&o.getAltTextExpression(),toolTipExpression:o.props.useDataSourcesEnabled&&o.getToolTipExpression(),linkUrlExpression:o.props.useDataSourcesEnabled&&o.getLinkUrlExpression(),attachmentInfos:[],symbolElement:null,widgetWidth:h[o.props.id+"-"+o.props.layoutId]&&h[o.props.id+"-"+o.props.layoutId].width,widgetHeight:h[o.props.id+"-"+o.props.layoutId]&&h[o.props.id+"-"+o.props.layoutId].height},o}return i(e,t),e.prototype.getStyle=function(){var t=this.props.config.functionConfig.symbolScale?this.props.config.functionConfig.symbolScale:1;return a.css(r||(r=s(["\n      .widget-image-container {\n        .btn-link {\n          border-bottom: 0;\n          border-top: 0;\n          border-left: 0;\n          border-right: 0;\n          padding: 0;\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .image-symbol {\n        svg {\n          transform: scale(",", ",")\n        }\n      }\n\n      .image-gallery-button {\n        cursor: pointer;\n        border-radius: 50%;\n        width: 24px;\n        height: 24px;\n        background-color: ",";\n      }\n\n      .image-gallery-button: hover {\n        background-color: ",";\n      }\n    "],["\n      .widget-image-container {\n        .btn-link {\n          border-bottom: 0;\n          border-top: 0;\n          border-left: 0;\n          border-right: 0;\n          padding: 0;\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .image-symbol {\n        svg {\n          transform: scale(",", ",")\n        }\n      }\n\n      .image-gallery-button {\n        cursor: pointer;\n        border-radius: 50%;\n        width: 24px;\n        height: 24px;\n        background-color: ",";\n      }\n\n      .image-gallery-button: hover {\n        background-color: ",";\n      }\n    "])),t,t,a.polished.rgba(this.props.theme.colors.white,.5),this.props.theme.colors.white)},e.prototype.componentDidMount=function(){this.__unmount=!1},e.prototype.componentDidUpdate=function(t,e){this.props.useDataSourcesEnabled||this.props.config===t.config&&!t.useDataSourcesEnabled||this.setState({src:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.imageParam&&this.props.config.functionConfig.imageParam.url||"",toolTip:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.toolTip,altText:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.altText,linkUrl:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.linkParam&&this.props.config.functionConfig.linkParam.value}),!this.props.useDataSourcesEnabled||this.props.config===t.config&&t.useDataSourcesEnabled||(this.checkIsStaticSrc(this.props.config.functionConfig.imgSourceType)?this.setState({src:this.props.config&&this.props.config.functionConfig&&this.props.config.functionConfig.imageParam&&this.props.config.functionConfig.imageParam.url||"",toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}):this.props.config.functionConfig.imgSourceType!==c.ImgSourceType.ByDynamicUrl||this.props.config.functionConfig.dynamicUrlType&&this.props.config.functionConfig.dynamicUrlType!==c.DynamicUrlType.Expression?this.setState({src:"",toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}):this.setState({srcExpression:this.getSrcExpression(),toolTipExpression:this.getToolTipExpression(),altTextExpression:this.getAltTextExpression(),linkUrlExpression:this.getLinkUrlExpression()}))},e.prototype.componentWillUnmount=function(){this.__unmount=!0,a.getAppStore().getState().appConfig.widgets[this.props.id]||delete h[this.props.id+"-"+this.props.layoutId]},e.prototype.render=function(){var t,e,o,n=this,i=this.props.useDataSourcesEnabled,s=this.state.toolTip,r=this.state.altText,h=null,d=this.props.config.functionConfig.imageParam?this.props.config.functionConfig.imageParam:a.Immutable({});d.set?d=d.set("url",this.state.src):d.url=this.state.src,t=a.jsx("div",{className:"jimu-widget"},a.jsx("div",{className:"jimu-widget widget-image image-param",style:{minHeight:"16px"}},this.props.config.functionConfig.dynamicUrlType!==c.DynamicUrlType.Attachment&&this.props.config.functionConfig.dynamicUrlType!==c.DynamicUrlType.Symbol&&a.jsx(p.ImageWithParam,{imageParam:d,toolTip:s,altText:r,onImageLoaded:this.handleImageLoaded,useFadein:!0,size:{width:this.state.widgetWidth,height:this.state.widgetHeight},imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.isAutoHeight}),this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Attachment&&a.jsx("div",{className:"w-100 h-100"},i&&a.jsx(f.ImageGallery,{sources:this.state.attachmentInfos,imageParam:d,imageFillMode:this.props.config.functionConfig.imageFillMode,size:{width:this.state.widgetWidth,height:this.state.widgetHeight},isAutoHeight:this.isAutoHeight,toolTip:s,altText:r,altTextWithAttachmentName:this.props.config.functionConfig.altTextWithAttachmentName,toolTipWithAttachmentName:this.props.config.functionConfig.toolTipWithAttachmentName,useFadein:!0}),!i&&a.jsx(p.ImageWithParam,{imageParam:d,toolTip:s,altText:r,useFadein:!0,size:{width:this.state.widgetWidth,height:this.state.widgetHeight},imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.isAutoHeight})),this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Symbol&&a.jsx("div",{className:"w-100 h-100"},(!this.state.symbolElement||!i)&&a.jsx(p.ImageWithParam,{imageParam:d,toolTip:s,altText:r,useFadein:!0,size:{width:this.state.widgetWidth,height:this.state.widgetHeight},imageFillMode:this.props.config.functionConfig.imageFillMode,isAutoHeight:this.isAutoHeight}),this.state.symbolElement&&i&&a.jsx("div",{className:"w-100 h-100 image-symbol",title:s,dangerouslySetInnerHTML:{__html:this.state.symbolElement.outerHTML}})),a.jsx(a.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:this.debounceOnResize})));var m=this.props.config.functionConfig.linkParam;m&&m.linkType&&(e=m.openType,o={linkType:m.linkType},m.linkType===a.LinkType.WebAddress?o.value=this.state.linkUrl:o.value=m.value);var y=m.linkType;if(h=y==a.LinkType.Page||y==a.LinkType.Dialog||y==a.LinkType.View?a.jsx("div",{className:"widget-image-container jimu-widget"},a.jsx(p.Link,{to:o,target:e,queryObject:this.props.queryObject},t)):y==a.LinkType.WebAddress?a.jsx("div",{className:"widget-image-container jimu-widget"},a.jsx(p.Link,{to:o,target:e},t)):t,this.props.config.functionConfig.imageFillMode!==p.ImageFillMode.Fit&&this.props.isInlineEditing&&this.state.src&&(!this.props.repeatedDataSource||this.props.repeatedDataSource&&0===this.props.repeatedDataSource.recordIndex)){var x=this.props.builderSupportModules.widgetModules.WidgetInBuilder;h=a.jsx("div",{className:"jimu-widget"},h,a.jsx(x,{widgetId:this.props.id,config:this.props.config,widgetWidth:this.getWidgetWidth(),widgetHeight:this.getWidgetHeight(),imageWidth:this.state.imageWidth,imageHeight:this.state.imageHeight}))}else h=a.jsx("div",{className:"jimu-widget",css:this.getStyle(),onClick:function(t){n.onClick(t)},onTouchEnd:function(t){n.onClick(t)}},h,a.jsx("div",{style:{display:"none"}},i&&this.props.config.functionConfig.imgSourceType===c.ImgSourceType.ByDynamicUrl&&(!this.props.config.functionConfig.dynamicUrlType||this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Expression)&&a.jsx("div",null,a.jsx(a.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getSrcExpression(),onChange:this.onSrcExpResolveChange,widgetId:this.props.id})),i&&a.jsx("div",null,a.jsx(a.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getAltTextExpression(),onChange:this.onAltTextExpResolveChange,widgetId:this.props.id}),a.jsx(a.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.getToolTipExpression(),onChange:this.onToolTipExpResolveChange,widgetId:this.props.id}),a.jsx(a.ExpressionResolverComponent,{useDataSources:this.props.useDataSources,expression:this.state.linkUrlExpression,onChange:this.onLinkUrlExpResolveChange,widgetId:this.props.id})),i&&this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Attachment&&a.jsx("div",null,a.jsx(u.AttachmentComponent,{record:this.state.record,onChange:this.onAttachmentInfosChange,attachmentTypes:this.attachmentTypes})),i&&this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Symbol&&a.jsx("div",null,a.jsx(l.SymbolComponent,{record:this.state.record,onChange:this.onSymbolElementChange})),i&&(this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Attachment||this.props.config.functionConfig.dynamicUrlType===c.DynamicUrlType.Symbol)&&a.jsx("div",null,a.jsx(g.RecordComponent,{widgetId:this.props.id,useDataSources:this.props.config.functionConfig.useDataSourceForMainDataAndViewSelector?a.Immutable([this.props.config.functionConfig.useDataSourceForMainDataAndViewSelector]):a.Immutable([]),isSelectedFromRepeatedDataSourceContext:this.props.config.functionConfig.isSelectedFromRepeatedDataSourceContext,onRecordChange:this.handleRecordChange}))));return h},e}(a.BaseWidget);e.default=d},381:function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e){var o=t.call(this,e)||this;return o.dataSources=null,o.__unmount=!1,o.isLoading=!1,o.resolveExpressions=function(t){if(t){var e=t;o.isLoading=!0,e&&e.queryAttachments&&e.queryAttachments(o.props.attachmentTypes).then((function(t){o.isLoading&&(o.isLoading=!1,o.setState({attachmentInfos:t}))}),(function(){o.isLoading=!1}))}else o.isLoading=!1,o.setState({attachmentInfos:null})},o.shallowEquals=function(t,e){return!t&&!e||!(!t||!e)&&(Object.keys(t).length===Object.keys(e).length&&!Object.keys(t).some((function(o){return t[o]!==e[o]})))},o.state={attachmentInfos:null},o}return i(e,t),e.prototype.componentDidMount=function(){this.__unmount=!1,this.resolveExpressions(this.props.record)},e.prototype.componentWillUnmount=function(){this.__unmount=!0},e.prototype.componentDidUpdate=function(t,e){this.shallowEquals(this.props.record,t.record)||this.resolveExpressions(this.props.record),e.attachmentInfos!==this.state.attachmentInfos&&this.props.onChange&&this.props.onChange(this.state.attachmentInfos)},e.prototype.render=function(){return null},e}(o(0).React.PureComponent);e.AttachmentComponent=s},382:function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var s=function(t){function e(e){var o=t.call(this,e)||this;return o.dataSources=null,o.__unmount=!1,o.isLoading=!1,o.resolveExpressions=function(t){if(t){var e=t;o.isLoading=!0,e&&e.getSymbolPreviewHTML&&e.getSymbolPreviewHTML().then((function(t){o.isLoading&&(o.isLoading=!1,o.setState({symbolElement:t}))}),(function(){o.isLoading=!1}))}else o.isLoading=!1,o.setState({symbolElement:null})},o.shallowEquals=function(t,e){return!t&&!e||!(!t||!e)&&(Object.keys(t).length===Object.keys(e).length&&!Object.keys(t).some((function(o){return t[o]!==e[o]})))},o.state={symbolElement:null},o}return i(e,t),e.prototype.componentDidMount=function(){this.__unmount=!1,this.resolveExpressions(this.props.record)},e.prototype.componentWillUnmount=function(){this.__unmount=!0},e.prototype.componentDidUpdate=function(t,e){this.shallowEquals(this.props.record,t.record)||this.resolveExpressions(this.props.record),e.symbolElement!==this.state.symbolElement&&this.props.onChange&&this.props.onChange(this.state.symbolElement)},e.prototype.render=function(){return null},e}(o(0).React.PureComponent);e.SymbolComponent=s},383:function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var s=o(0),r=function(t){function e(e){var o=t.call(this,e)||this;return o.dataSources=null,o.__unmount=!1,o.updateRecord=function(){var t=o.getSingleRecord();o.props.onRecordChange&&o.props.onRecordChange(t)},o.shallowEquals=function(t,e){return!t&&!e||!(!t||!e)&&(Object.keys(t).length===Object.keys(e).length&&!Object.keys(t).some((function(o){return t[o]!==e[o]})))},o.getSingleRecord=function(){var t,e;if(o.props.isSelectedFromRepeatedDataSourceContext){var n=o.props.repeatedDataSource;return a=Array.isArray(n)?null===(t=n[0])||void 0===t?void 0:t.record:null===(e=n)||void 0===e?void 0:e.record}if(!o.props.useDataSources||0===o.props.useDataSources.length)return null;var i=o.props.useDataSources[0].dataSourceId;if(i.split("-").reverse()[0]===s.CONSTANTS.SELECTION_DATA_VIEW_ID){var r,a;if(!(a=null==(r=s.DataSourceManager.getInstance().getDataSource(i))?void 0:r.getRecords()[0])){var p=null==r?void 0:r.getMainDataSource().getDataView(s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION);a=null==p?void 0:p.getRecords()[0]}return a}return a=null==(r=s.DataSourceManager.getInstance().getDataSource(i))?void 0:r.getRecords()[0]},o.onDataSourceCreated=function(t){if(o.dataSources=t,t){var e={};Object.keys(t).forEach((function(o){o&&t[o]&&(e[o]=t[o].getInfo())})),o.setState({infos:e})}},o.onDataSourceInfoChange=function(t){o.setState({infos:t})},o.addDataViewForNoSelection=function(t){var e=s.Immutable([]);return t?(t.forEach((function(t){if(t.mainDataSourceId&&!e.some((function(e){return e.mainDataSourceId===t.mainDataSourceId}))){var o=s.DataSourceManager.getInstance().getDataSource(t.mainDataSourceId),n=o&&o.getDataSourceJson();(null==n?void 0:n.dataViews)&&(null==n?void 0:n.dataViews[s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION])&&(e=e.concat(t.set("dataSourceId",s.DataSourceManager.getInstance().getDataViewDataSourceId(t.mainDataSourceId,s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)).set("dataViewId",s.CONSTANTS.DATA_VIEW_ID_FOR_NO_SELECTION)))}})),e.concat(t)):e},o.getQueries=function(t){var e={};return t?(t.forEach((function(t){e[t.dataSourceId]={}})),e):e},o.state={infos:null},o}return i(e,t),e.prototype.componentDidMount=function(){this.__unmount=!1,this.updateRecord()},e.prototype.componentDidUpdate=function(t,e){this.props.isSelectedFromRepeatedDataSourceContext?this.props.repeatedDataSource!==t.repeatedDataSource&&this.updateRecord():this.props.useDataSources===t.useDataSources&&this.shallowEquals(this.state.infos,e.infos)||this.updateRecord()},e.prototype.render=function(){var t=this.addDataViewForNoSelection(this.props.useDataSources);return s.React.createElement(s.MultipleDataSourceComponent,{useDataSources:t,onDataSourceCreated:this.onDataSourceCreated,onDataSourceInfoChange:this.onDataSourceInfoChange,queries:this.getQueries(t),widgetId:this.props.widgetId})},e}(s.React.PureComponent);e.RecordComponent=s.withRepeatedDataSource(r)},384:function(t,e,o){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(e,"__esModule",{value:!0});var s=o(0),r=o(1),a=o(16),p=o(13),c=function(t){function e(e){var o=t.call(this,e)||this;return o.backImg=function(){var t=o.state.currentIndex>0?o.state.currentIndex-1:o.props.sources.length-1;o.setState({currentIndex:t})},o.forwardImg=function(){var t=o.state.currentIndex<o.props.sources.length-1?o.state.currentIndex+1:0;o.setState({currentIndex:t})},o.state={currentIndex:0},o}return i(e,t),e.prototype.componentDidUpdate=function(t,e){t.sources!==this.props.sources&&this.setState({currentIndex:0})},e.prototype.render=function(){var t={},e=this.props.toolTipWithAttachmentName?this.props.sources&&this.props.sources[this.state.currentIndex]&&this.props.sources[this.state.currentIndex].name:this.props.toolTip,o=this.props.altTextWithAttachmentName?this.props.sources&&this.props.sources[this.state.currentIndex]&&this.props.sources[this.state.currentIndex].name:this.props.altText;return this.props.imageParam.set?t=this.props.imageParam.set("url",this.props.sources&&this.props.sources[this.state.currentIndex]&&this.props.sources[this.state.currentIndex].url):t.url=this.props.sources&&this.props.sources[this.state.currentIndex]&&this.props.sources[this.state.currentIndex].url,s.React.createElement("div",{className:"w-100 h-100"},this.props.sources&&this.props.sources.length>1&&s.React.createElement("div",{title:e,className:"silder-tool-container w-100 h-100",style:{position:"absolute",zIndex:1}},s.React.createElement("div",{className:"d-flex justify-content-center align-items-center image-gallery-button ml-2",onClick:this.backImg,style:{top:"50%",transform:"translateY(-50%)",position:"absolute"}},s.React.createElement(r.Icon,{size:"12",icon:a})),s.React.createElement("div",{className:"d-flex justify-content-center align-items-center image-gallery-button mr-2",onClick:this.forwardImg,style:{top:"50%",transform:"translateY(-50%)",position:"absolute",right:0}},s.React.createElement(r.Icon,{size:"12",icon:p}))),s.React.createElement("div",{className:"image-gallery-content w-100 h-100"},s.React.createElement(r.ImageWithParam,{imageParam:t,useFadein:!0,size:this.props.size,imageFillMode:this.props.imageFillMode,isAutoHeight:this.props.isAutoHeight,toolTip:e,altText:o})))},e}(s.React.PureComponent);e.ImageGallery=c}})}));