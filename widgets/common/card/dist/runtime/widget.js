define(["jimu-core","jimu-ui","jimu-layouts/layout-runtime"],(function(e,t,n){return function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=299)}({0:function(t,n){t.exports=e},1:function(e,n){e.exports=t},134:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e};Object.defineProperty(t,"__esModule",{value:!0});var a,s=n(0),l=n(45),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.formatMessage=function(e,n){return t.props.formatMessage(e,n)},t.getWidgetSize=function(){var e=t.props,n=e.isHeightAuto,o=e.isWidthAuto,i=e.cardConfigs,r={};return n&&(r.height={value:(i.widgetHeight||l.MIN_WIDGET_HEIGHT)+"px"}),o&&(r.width={value:(i.widgetWidth||l.MIN_WIDGET_WIDTH)+"px"}),r},t.getStyle=function(){var e=t.props.widgetId;return s.css(a||(a=r(["\n    &{\n      overflow: hidden;\n    }\n    .card-link {\n      cursor: pointer;\n    }\n    "," {\n      padding: 0;\n      border: 0;\n      background-color: transparent;\n      height: 100%;\n      position: relative;\n      .card-content {\n        width: 100%;\n        height: 100%;\n        /* overflow: hidden; */\n        &>div {\n          width: 100%;\n          height: 100%;\n        }\n      }\n    }\n    .edit-mask {\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n    }\n    .clear-background {\n      background: transparent;\n      z-index: 100;\n    }\n    .clear-background:focus {\n      outline: none;\n    }\n    .surface-1 {\n      border: none !important;\n    }\n    ",":hover {}\n    "],["\n    &{\n      overflow: hidden;\n    }\n    .card-link {\n      cursor: pointer;\n    }\n    "," {\n      padding: 0;\n      border: 0;\n      background-color: transparent;\n      height: 100%;\n      position: relative;\n      .card-content {\n        width: 100%;\n        height: 100%;\n        /* overflow: hidden; */\n        &>div {\n          width: 100%;\n          height: 100%;\n        }\n      }\n    }\n    .edit-mask {\n      left: 0;\n      right: 0;\n      top: 0;\n      bottom: 0;\n    }\n    .clear-background {\n      background: transparent;\n      z-index: 100;\n    }\n    .clear-background:focus {\n      outline: none;\n    }\n    .surface-1 {\n      border: none !important;\n    }\n    ",":hover {}\n    "])),"&.card-"+e,"&.card-"+e)},t}return i(t,e),t}(s.React.PureComponent);t.default=d},2:function(e,t){e.exports=n},299:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,l=n(0),d=n(1),u=n(45),p=n(300),c=n(301),f=n(2),g=n(302),v=function(e){function t(t){var n=e.call(this,t)||this;n.onResize=function(e,t){var o=n.props.config;n.updateCardToolPosition(),e>0&&(o=o.setIn(["widgetWidth"],e)),t>0&&(o=o.setIn(["widgetHeight"],t)),(e>0||t>0)&&n.editWidgetConfig(o)},n.updateCardToolPosition=function(){n.setState({hideCardTool:!0}),n.updateCardToolTimeout&&(clearTimeout(n.updateCardToolTimeout),n.updateCardToolTimeout=void 0),n.updateCardToolTimeout=setTimeout((function(){n.setState({hideCardTool:!1})}),500)},n.formatMessage=function(e,t){return n.props.intl.formatMessage({id:e,defaultMessage:a(a({},g.default),l.defaultMessages)[e]},t)},n.editStatus=function(e,t){var o=n.props,i=o.dispatch,r=o.id;i(l.appActions.widgetStatePropChange(r,e,t))},n.editWidgetConfig=function(e){window.jimuConfig.isInBuilder&&n.props.builderSupportModules.jimuForBuilderLib.getAppConfigAction().editWidgetConfig(n.props.id,e).exec()},n.isEditing=function(){var e=n.props,t=e.appMode,o=e.config,i=e.selectionIsSelf,r=e.selectionIsInSelf;return!!window.jimuConfig.isInBuilder&&((i||r)&&window.jimuConfig.isInBuilder&&t!==l.AppMode.Run&&o.isItemStyleConfirm)},n.editBuilderAndSettingStatus=function(e){n.editStatus("showCardSetting",e),n.editStatus("builderStatus",e)},n.getAppConfig=function(){return l.getAppStore().getState().appConfig},n.getStyle=function(e){var t=n.props.id;return l.css(s||(s=r(["\n      "," {\n        overflow: visible;\n        background-color: transparent;\n        border: "," solid ",";\n        width: 100%;\n        height: 100%;\n      }\n    "],["\n      "," {\n        overflow: visible;\n        background-color: transparent;\n        border: "," solid ",";\n        width: 100%;\n        height: 100%;\n      }\n    "])),"&.card-widget-"+t,l.polished.rem(0),l.polished.rgba(e.colors.black,window.jimuConfig.isInBuilder&&n.isEditing()?.2:0))},n.getCardProps=function(){var e=n.props,t=e.config,o=e.selectionIsInSelf,i=e.selectionIsSelf,r=e.builderStatus,s=e.appMode,d=e.queryObject,u=window.jimuConfig.isInBuilder&&s===l.AppMode.Design?{hideCardTool:n.state.hideCardTool,selectionIsCard:i,selectionIsInCard:o,isEditing:n.isEditing(),builderStatus:r,selectSelf:n.selectSelf}:{linkParam:t.linkParam,queryObject:d};return a(a({},n.getOtherProps()),u)},n.getOtherProps=function(){var e=n.props,t=e.config,o=e.theme,i=e.id,r=e.appMode,a=e.builderSupportModules,s=e.layouts,l=e.browserSizeMode,d=e.dispatch,u=e.isRTL,p=e.isHeightAuto,c=e.isWidthAuto;return{browserSizeMode:l,isRTL:u,builderSupportModules:a,formatMessage:n.formatMessage,dispatch:d,widgetId:i,interact:window.jimuConfig.isInBuilder&&a.widgetModules.interact,appMode:r,theme:o,LayoutEntry:n.state.LayoutEntry,layouts:s,cardConfigs:t,isHeightAuto:p,isWidthAuto:c}},n.cardRender=function(){var e=n.getCardProps(),t=n.props.appMode,o=window.jimuConfig.isInBuilder&&t===l.AppMode.Design?p.default:c.default;return l.jsx(o,a({},e))};var o={LayoutEntry:null,hideCardTool:!1};return window.jimuConfig.isInBuilder?o.LayoutEntry=n.props.builderSupportModules.LayoutEntry:o.LayoutEntry=f.FixedLayoutViewer,n.state=o,n.onResize=n.onResize.bind(n),n.selectSelf=n.selectSelf.bind(n),n.debounceOnResize=l.lodash.debounce((function(e,t){return n.onResize(e,t)}),200),n}return i(t,e),t.prototype.componentDidUpdate=function(e,t){var n=this.props,o=n.appMode,i=n.selectionIsSelf,r=n.selectionStatus,a=n.builderStatus,s=n.left,d=n.top;o!==l.AppMode.Run&&r!==a&&(r?this.editBuilderAndSettingStatus(r):i||this.editBuilderAndSettingStatus(u.Status.Regular)),e.appMode!=o&&o===l.AppMode.Run&&this.editBuilderAndSettingStatus(u.Status.Regular),d===e.top&&s===e.left||this.updateCardToolPosition()},t.prototype.componentDidMount=function(){var e=this.props,t=e.layoutId,n=e.layoutItemId,o=e.id;this.props.dispatch(l.appActions.widgetStatePropChange(o,"layoutInfo",{layoutId:t,layoutItemId:n}))},t.prototype.selectSelf=function(){if(!window.jimuConfig.isInBuilder)return!1;var e=this.props,t={layoutId:e.layoutId,layoutItemId:e.layoutItemId};this.props.dispatch(l.appActions.selectionChanged(t))},t.prototype.render=function(){var e=this.props,t=e.config,o=e.id,i=l.classNames("jimu-widget","widget-card","card-widget-"+o);return t.itemStyle?l.jsx("div",{className:i,css:this.getStyle(this.props.theme)},this.cardRender(),l.jsx(l.ReactResizeDetector,{handleWidth:!0,handleHeight:!0,onResize:this.debounceOnResize})):l.jsx(d.WidgetPlaceholder,{widgetId:this.props.id,icon:n(303),message:this.formatMessage("placeHolderTip")})},t.mapExtraStateProps=function(e,t){var n,o,i,r,a,s,l,d,p,c,g,v,y,h,S,m,I=e&&e.appConfig,b=t.layouts,w=t.layoutId,C=t.layoutItemId,M=t.builderSupportModules,x=t.id,j=null==e?void 0:e.browserSizeMode,T=(null==e?void 0:e.widgetsState[t.id])&&(null===(n=null==e?void 0:e.widgetsState[t.id])||void 0===n?void 0:n.builderStatus)||u.Status.Regular,L=e&&e.appRuntimeInfo&&e.appRuntimeInfo.selection,R=L&&M&&M.widgetModules&&M.widgetModules.selectionInCard(L,x,I,!1);R&&(m=Object.keys(b).find((function(e){return f.searchUtils.findLayoutId(b[e],j,I.mainSizeMode)===L.layoutId})));var _=null===(o=I.layouts)||void 0===o?void 0:o[w],k=null===(r=null===(i=null==_?void 0:_.content)||void 0===i?void 0:i[C])||void 0===r?void 0:r.setting,O=(null===(a=null==k?void 0:k.autoProps)||void 0===a?void 0:a.height)===f.LayoutItemSizeModes.Auto||!0===(null===(s=null==k?void 0:k.autoProps)||void 0===s?void 0:s.height),P=(null===(l=null==k?void 0:k.autoProps)||void 0===l?void 0:l.width)===f.LayoutItemSizeModes.Auto||!0===(null===(d=null==k?void 0:k.autoProps)||void 0===d?void 0:d.width),A=void 0;if(window.jimuConfig.isInBuilder){var H=null===(v=null===(g=null===(c=null===(p=I.layouts)||void 0===p?void 0:p[w])||void 0===c?void 0:c.content)||void 0===g?void 0:g[C])||void 0===v?void 0:v.bbox;A=H&&{left:H.left,top:H.top}}return{selectionIsSelf:L&&L.layoutId===w&&L.layoutItemId===C,selectionIsInSelf:R,selectionStatus:m,appMode:null===(y=null==e?void 0:e.appRuntimeInfo)||void 0===y?void 0:y.appMode,browserSizeMode:null==e?void 0:e.browserSizeMode,builderStatus:T,currentPageId:null===(h=null==e?void 0:e.appRuntimeInfo)||void 0===h?void 0:h.currentPageId,isRTL:null===(S=null==e?void 0:e.appContext)||void 0===S?void 0:S.isRTL,left:A&&A.left,top:A&&A.top,isHeightAuto:O,isWidthAuto:P}},t}(l.BaseWidget);t.Widget=v,t.default=v},300:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__makeTemplateObject||function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var s,l,d,u=n(0),p=n(1),c=n(45),f=n(2),g=n(134),v=n(85),y=n(86),h=[0,5],S=[{name:"flip",options:{boundary:document.body,fallbackPlacements:["right-start","bottom-start","top-start"]}}],m=[{name:"offset",options:{offset:[0,10]}},{name:"arrow",enabled:!0}],I=function(e){function t(t){var n=e.call(this,t)||this;return n.lastResizeCall=null,n.handleCopyTo=function(e,t,o,i){if(o){var r=n.props,a=r.layouts,s=r.builderSupportModules,l=r.browserSizeMode,d=r.builderStatus,p=s.jimuForBuilderLib.getAppConfigAction(),c=p.appConfig,g=f.searchUtils.findLayoutId(a[d],l,c.mainSizeMode),v=f.searchUtils.findLayoutId(a[t],l,c.mainSizeMode);if(i){var y=s.widgetModules.searchUtils.getContainerLayoutItem(c.layouts[v],o.widgetId,u.LayoutItemType.Widget);y&&p.removeLayoutItem({layoutId:v,layoutItemId:y.id},!1)}p.duplicateLayoutItem(g,v,o.id,!1,i),p.exec(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},n.editStatus=function(e,t){var o=n.props,i=o.dispatch,r=o.widgetId;i(u.appActions.widgetStatePropChange(r,e,t))},n.toggleStatus=function(e){var t,o=n.props.cardConfigs,i=null===(t=null==o?void 0:o.HOVER)||void 0===t?void 0:t.enable,r=e===c.Status.Hover,a=n.state,s=a.previousIndex,l=a.currentIndex,d=a.hoverPlayId,u=a.regularPlayId;i&&(s=r?0:1,l=r?1:0,d=r?Symbol():null,u=r?null:Symbol()),n.setState({previousIndex:s,currentIndex:l,hoverPlayId:d,regularPlayId:u})},n.handleBreakLink=function(e){var t=n.props,o=t.layouts,i=t.builderSupportModules,r=t.browserSizeMode,a=t.selection,s=t.builderStatus,l=t.dispatch,d=i.jimuForBuilderLib.getAppConfigAction(),p=d.appConfig,c=f.searchUtils.findLayoutItem(p,a);if(c){var g=f.searchUtils.findLayoutId(o[s],r,p.mainSizeMode);d.duplicateLayoutItem(g,g,c.id,!0),d.removeLayoutItem({layoutId:g,layoutItemId:c.id},!1),d.exec(),a.layoutId===g&&a.layoutItemId===c.id&&l(u.appActions.selectionChanged(null));var v=d.appConfig.layouts[g].content,y=Object.keys(v)[Object.keys(v).length-1];if(y){var h=v[y];l(u.appActions.selectionChanged({layoutId:g,layoutItemId:h.id}))}e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()}},n.getCopyDropdownItems=function(e){var t=n.props,o=t.cardConfigs,i=t.layouts,r=t.browserSizeMode,a=t.selection,s=t.builderStatus,l=t.builderSupportModules,d=l.jimuForBuilderLib.getAppConfigAction().appConfig,p=f.searchUtils.findLayoutItem(d,a);if(!a||!p||!window.jimuConfig.isInBuilder)return{items:u.Immutable([]),title:""};var g,v=[],y="",h=!0,S=!0,m=function(e,t){return l.widgetModules.searchUtils.getWidgetsOrSectionsInLayoutWithLayoutWidgetOnly(d,e,u.LayoutItemType.Widget,r).indexOf(t)>-1};return s===c.Status.Regular?(!function(){if(o[c.Status.Hover]){var e=f.searchUtils.findLayoutId(i[c.Status.Hover],r,d.mainSizeMode);m(e,d.layouts[a.layoutId].content[a.layoutItemId].widgetId)||(S=!1),v.push({label:n.formatMessage("applyTo",{status:n.formatMessage("hover").toLocaleLowerCase()}),event:function(e){n.handleCopyTo(e,c.Status.Hover,p,S)}})}}(),y=n.formatMessage("linkedTo",{where:n.formatMessage("hover").toLocaleLowerCase()})):s===c.Status.Hover&&(g=f.searchUtils.findLayoutId(i[c.Status.Regular],r,d.mainSizeMode),m(g,d.layouts[a.layoutId].content[a.layoutItemId].widgetId)||(h=!1),v.push({label:n.formatMessage("applyTo",{status:n.formatMessage("regular").toLocaleLowerCase()}),event:function(e){n.handleCopyTo(e,c.Status.Regular,p,h)}}),y=n.formatMessage("linkedTo",{where:n.formatMessage("regular").toLocaleLowerCase()})),e?v.push({label:n.formatMessage("isolate"),event:n.handleBreakLink}):y=n.formatMessage("isolate"),{items:u.Immutable(v),title:y}},n.getCardToolsStyle=function(e){return u.css(s||(s=r(["\n        width: 100%;\n        .btn {\n          width: 100%;\n        }\n        .dropdown-toggle {\n          justify-content: center;\n        }\n        "],["\n        width: 100%;\n        .btn {\n          width: 100%;\n        }\n        .dropdown-toggle {\n          justify-content: center;\n        }\n        "])))},n.renderCardTools=function(){if(window.jimuConfig.isInBuilder){var e=n.props,t=e.selection,o=e.widgetId,i=e.builderSupportModules,a=e.browserSizeMode,s=e.builderStatus,d=e.selectionIsCard,f=e.selectionIsInCard,g=e.appMode,I=e.hideCardTool,b=e.cardConfigs,w=i.jimuForBuilderLib.getAppConfigAction().appConfig,C=i.widgetModules,M=C.searchUtils,x=C.BuilderDropDown,j=C.BuilderPopper,T=C.GLOBAL_RESIZING_CLASS_NAME,L=C.GLOBAL_H5_DRAGGING_CLASS_NAME,R=C.GLOBAL_DRAGGING_CLASS_NAME,_=C.BuilderButton,k=C.withBuilderTheme,O=d,P=!0,A=!O&&t&&M&&M.getLayoutItemsInWidgetByLayoutInfo(w,t,o,a).length>1,H=n.getCopyDropdownItems(A),B=H.items,E=H.title,z=B&&B.length>0;(!f&&!O||g===u.AppMode.Run||I)&&(P=!1);var N=k((function(e){return u.jsx("div",{className:"status-group d-flex flex-column align-items-center p-2",css:n.getCardToolsStyle(e)},u.jsx(_,{active:s===c.Status.Regular,onClick:function(e){return n.handleBuilderStatusChange(e,c.Status.Regular)}},n.formatMessage("regular")),u.jsx(_,{active:s===c.Status.Hover,className:"mt-1",onClick:function(e){return n.handleBuilderStatusChange(e,c.Status.Hover)}},n.formatMessage("hover")),!O&&(z||A)&&u.jsx(x,{className:"mt-1 w-100",toggleIsIcon:!0,toggleTitle:E,toggleType:"default",direction:"left",toggleContent:function(e){return u.jsx(p.Icon,{icon:A?y:v,size:16})},modifiers:m,items:B}))}));return n.props.isEditing&&b[c.Status.Hover].enable&&u.jsx(j,{placement:"left-start",css:u.css(l||(l=r(["\n          ."," &,\n          ."," &,\n          ."," & {\n            &.popper{\n              display: none;\n            }\n          }\n        "],["\n          ."," &,\n          ."," &,\n          ."," & {\n            &.popper{\n              display: none;\n            }\n          }\n        "])),R,T,L),reference:n.layoutRef.current,offset:h,modifiers:S,open:P},N())}},n.getEditorStyle=function(){return u.css(d||(d=r(["\n      &.card-content {\n        .fixed-layout {\n          border: 0 !important;\n        }\n      }\n    "],["\n      &.card-content {\n        .fixed-layout {\n          border: 0 !important;\n        }\n      }\n    "])))},n.renderCardEditor=function(){var e=n.props,t=e.cardConfigs,o=e.LayoutEntry,i=e.layouts,r=e.appMode,s=n.state,l=s.hoverPlayId,d=s.regularPlayId,f=i[c.Status.Regular],g=i[c.Status.Hover],v=t[c.Status.Regular].backgroundStyle.setIn(["boxShadow","color"],"transparent"),y=t[c.Status.Hover].backgroundStyle.setIn(["boxShadow","color"],"transparent"),h=window.jimuConfig.isInBuilder&&r===u.AppMode.Design,S=t.transitionInfo,m=[],I=a({},p.styleUtils.toCSSStyle(v||{})),b=u.jsx("div",{className:"card-content d-flex surface-1",css:n.getEditorStyle(),ref:n.regularLayoutRef,key:c.Status.Regular},u.jsx("div",{className:"w-100, h-100",style:I},u.jsx(u.AnimationContext.Provider,{value:{isDesignMode:h,trigger:u.AnimationTriggerType.Manual,setting:(null==S?void 0:S.oneByOneEffect)||null,inheritedOneByOneSetting:null,playId:d,depth:100}},u.jsx(o,{className:"h-100",isRepeat:!0,layouts:f,isInWidget:!0}))));if(m.push(b),!t[c.Status.Hover].enable)return m;var w=a({},p.styleUtils.toCSSStyle(y||{})),C=u.jsx("div",{className:"card-content d-flex surface-1",css:n.getEditorStyle(),ref:n.hoverLayoutRef,key:c.Status.Hover},u.jsx("div",{className:"w-100, h-100",style:w},u.jsx(u.AnimationContext.Provider,{value:{isDesignMode:h,trigger:u.AnimationTriggerType.Manual,setting:(null==S?void 0:S.oneByOneEffect)||null,inheritedOneByOneSetting:null,playId:l,depth:100}},u.jsx(o,{className:"h-100",isRepeat:!0,layouts:g,isInWidget:!0}))));return m.push(C),m},n.getCardStyle=function(){var e,t,o,i,r=n.props,s=r.builderStatus,l=r.cardConfigs,d=l[c.Status.Hover].enable?s:c.Status.Regular,u={boxShadow:null===(t=null===(e=l[d])||void 0===e?void 0:e.backgroundStyle)||void 0===t?void 0:t.boxShadow,borderRadius:null===(i=null===(o=l[d])||void 0===o?void 0:o.backgroundStyle)||void 0===i?void 0:i.borderRadius},f=n.getWidgetSize();return a({},p.styleUtils.toCSSStyle(a(a({},f),u)))},n.state={didMount:!1,previousIndex:1,currentIndex:0,regularPlayId:null,hoverPlayId:null},n.regularLayoutRef=u.React.createRef(),n.hoverLayoutRef=u.React.createRef(),n.layoutRef=u.React.createRef(),n.isUpdateFirst=!0,n}return i(t,e),t.prototype.componentDidMount=function(){this.setState({didMount:!0})},t.prototype.componentDidUpdate=function(e){var t,n,o=this.props,i=o.cardConfigs,r=o.builderStatus,a=o.isEditing,s=e.cardConfigs,l=(null===(t=null==s?void 0:s.transitionInfo)||void 0===t?void 0:t.previewId)==(null===(n=null==i?void 0:i.transitionInfo)||void 0===n?void 0:n.previewId),d=e.builderStatus&&e.builderStatus!=r&&!this.isUpdateFirst,u=s[c.Status.Hover].enable!=i[c.Status.Hover].enable;(!l||d||u)&&this.toggleStatus(r),a||this.isUpdateFirst||this.setState({previousIndex:1,currentIndex:0}),this.isUpdateFirst&&(this.isUpdateFirst=!1)},t.prototype.handleBuilderStatusChange=function(e,t){var n;this.editStatus("showCardSetting",t),this.editStatus("builderStatus",t),null===(n=null==this?void 0:this.props)||void 0===n||n.selectSelf(),e.stopPropagation(),e.nativeEvent.stopImmediatePropagation()},t.prototype.render=function(){var e,t,n=this.props,o=n.cardConfigs,i=n.widgetId,r=n.isEditing,a=this.state,s=a.didMount,l=a.previousIndex,d=a.currentIndex,p=o.transitionInfo,c="card-"+i,f=(null==p?void 0:p.previewId)||null;return u.jsx("div",{css:this.getStyle(),style:this.getCardStyle(),className:c},s&&this.renderCardTools(),u.jsx("div",{className:"w-100, h-100",ref:this.layoutRef},u.jsx(u.TransitionContainer,{previousIndex:l,currentIndex:d,transitionType:null===(e=null==p?void 0:p.transition)||void 0===e?void 0:e.type,direction:null===(t=null==p?void 0:p.transition)||void 0===t?void 0:t.direction,playId:s?f:null,withOneByOne:!!(null==p?void 0:p.oneByOneEffect)},this.renderCardEditor())),!r&&u.jsx("div",{className:"edit-mask position-absolute"}))},t}(g.default);t.default=u.ReactRedux.connect((function(e,t){var n,o=t.appMode;return window.jimuConfig.isInBuilder&&o!==u.AppMode.Run?{selection:t.selectionIsInCard&&(null===(n=null==e?void 0:e.appRuntimeInfo)||void 0===n?void 0:n.selection)}:{selection:void 0}}))(I)},301:function(e,t,n){"use strict";var o,i=this&&this.__extends||(o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),r=this&&this.__assign||function(){return(r=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.defineProperty(t,"__esModule",{value:!0});var a=n(0),s=n(1),l=n(2),d=n(45),u=function(e){function t(t){var n=e.call(this,t)||this;return n.handleItemClick=function(e){var t=n.linkRef,o=e.target&&e.target.tagName||"";"a"!==o.toLowerCase()&&"button"!==o.toLowerCase()&&"linkClick"!==e.exbEventType&&t.current&&t.current.click(),"linkClick"===e.exbEventType&&delete e.exbEventType},n.handleLinkClick=function(e){e.stopPropagation()},n.onMouse=function(e,t){var o;void 0===t&&(t=!1),e.stopPropagation();var i=n.props.cardConfigs,r=null===(o=null==i?void 0:i.HOVER)||void 0===o?void 0:o.enable,a=n.state,s=a.previousIndex,l=a.currentIndex,d=a.hoverPlayId,u=a.regularPlayId;r&&(s=t?0:1,l=t?1:0,d=t?Symbol():null,u=t?null:Symbol()),n.setState({isHover:t,previousIndex:s,currentIndex:l,hoverPlayId:d,regularPlayId:u})},n.getCardContent=function(){var e,t,o,i,u,p,c,f=n.props,g=f.cardConfigs,v=f.layouts,y=f.appMode,h=f.linkParam,S=n.props.queryObject,m=n.state,I=m.hoverPlayId,b=m.regularPlayId,w=null==g?void 0:g.transitionInfo,C=window.jimuConfig.isInBuilder&&y===a.AppMode.Design,M=null===(e=null==g?void 0:g.HOVER)||void 0===e?void 0:e.enable,x=[];window.jimuConfig.isInBuilder&&y!==a.AppMode.Run?(o=n.getBackgroundStyle(d.Status.Regular),t=v[d.Status.Regular],M&&(u=n.getBackgroundStyle(d.Status.Hover),i=v[d.Status.Hover])):(t=v[d.Status.Regular],o=n.getBackgroundStyle(d.Status.Regular),h&&h.linkType&&(p=h.openType,c={linkType:h.linkType},h.linkType===a.LinkType.WebAddress?(c.value=(null==h?void 0:h.value)||"",S=void 0):c.value=h.value),M&&(i=v[d.Status.Hover],u=n.getBackgroundStyle(d.Status.Hover)));var j=r({},s.styleUtils.toCSSStyle(o||{})),T=(null==h?void 0:h.linkType)&&(null==h?void 0:h.linkType)!=a.LinkType.None,L=a.jsx("div",{className:a.classNames("card-content d-flex surface-1",T?"card-link":""),key:d.Status.Regular},a.jsx("div",{className:"w-100",style:j},T&&a.jsx(s._Link,{className:"p-0 w-100 h-100 position-absolute  border-0 clear-background",ref:n.linkRef,to:c,onClick:n.handleLinkClick,target:p,queryObject:S}),a.jsx("div",{className:"d-flex w-100 h-100",ref:n.regularLayoutRef},a.jsx(a.AnimationContext.Provider,{value:{isDesignMode:C,trigger:a.AnimationTriggerType.Manual,setting:(null==w?void 0:w.oneByOneEffect)||null,inheritedOneByOneSetting:null,playId:b,depth:100}},a.jsx(l.FixedLayoutViewer,{layouts:t})))));if(x.push(L),M){var R=r({},s.styleUtils.toCSSStyle(u||{})),_=a.jsx("div",{className:a.classNames("card-content d-flex surface-1",T?"card-link":""),key:d.Status.Hover},a.jsx("div",{className:"w-100",style:R},T&&a.jsx(s._Link,{className:"p-0 w-100 h-100 position-absolute border-0 clear-background",ref:n.linkRef,to:c,onClick:n.handleLinkClick,target:p,queryObject:S}),a.jsx("div",{className:"d-flex w-100 h-100",ref:n.hoverLayoutRef},a.jsx(a.AnimationContext.Provider,{value:{isDesignMode:C,trigger:a.AnimationTriggerType.Manual,setting:(null==w?void 0:w.oneByOneEffect)||null,inheritedOneByOneSetting:null,playId:I,depth:100}},a.jsx(l.FixedLayoutViewer,{layouts:i})))));x.push(_)}return x},n.getBackgroundStyle=function(e){var t=n.props.cardConfigs[e].backgroundStyle;return(null==t?void 0:t.boxShadow)?t.setIn(["boxShadow","color"],"transparent"):t},n.getCardShadowStyle=function(){var e,t,o=n.props.cardConfigs,i=n.state.isHover&&o[d.Status.Hover].enable?d.Status.Hover:d.Status.Regular,a={boxShadow:null===(e=o[i].backgroundStyle)||void 0===e?void 0:e.boxShadow,borderRadius:null===(t=o[i].backgroundStyle)||void 0===t?void 0:t.borderRadius},l=n.getWidgetSize();return r({},s.styleUtils.toCSSStyle(r(r({},a),l)))},n.state={url:"",isHover:!1,previousIndex:1,currentIndex:0,regularPlayId:null,hoverPlayId:null},n.regularLayoutRef=a.React.createRef(),n.hoverLayoutRef=a.React.createRef(),n.linkRef=a.React.createRef(),n.didMount=!1,n}return i(t,e),t.prototype.componentDidMount=function(){this.didMount=!0},t.prototype.componentDidUpdate=function(e){var t,n,o=this.props.cardConfigs,i=e.cardConfigs;(null===(t=null==o?void 0:o.transitionInfo)||void 0===t?void 0:t.previewId)==(null===(n=null==i?void 0:i.transitionInfo)||void 0===n?void 0:n.previewId)||this.setState({hoverPlayId:Symbol(),regularPlayId:Symbol()})},t.prototype.render=function(){var e,t,n=this,o=this.props,i=o.widgetId,r=o.cardConfigs,s=this.state,l=s.previousIndex,d=s.currentIndex,u=r.transitionInfo,p="card-"+i,c=(null==u?void 0:u.previewId)||null;return a.jsx("div",{css:this.getStyle(),style:this.getCardShadowStyle(),className:p,onMouseLeave:function(e){n.onMouse(e,!1)},onMouseEnter:function(e){n.onMouse(e,!0)},onClick:this.handleItemClick},a.jsx(a.TransitionContainer,{previousIndex:l,currentIndex:d,transitionType:null===(e=null==u?void 0:u.transition)||void 0===e?void 0:e.type,direction:null===(t=null==u?void 0:u.transition)||void 0===t?void 0:t.direction,playId:this.didMount?c:null,withOneByOne:!!(null==u?void 0:u.oneByOneEffect)},this.getCardContent()))},t}(n(134).default);t.default=u},302:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={applyTo:"Apply to {status}",isolate:"Isolate",linkedToAnd:"Linked to {where1} and {where2}",linkedTo:"Linked to {where}",placeHolderTip:"Please select a card template.",showSelected:"Show selection",_widgetLabel:"Card"}},303:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M2 3a1 1 0 100-2 1 1 0 000 2zm0 1a2 2 0 110-4 2 2 0 010 4zm5-3a1 1 0 000 2h7a1 1 0 000-2H7zm0-1h7a2 2 0 110 4H7a2 2 0 110-4zm0 7a1 1 0 000 2h7a1 1 0 000-2H7zm0-1h7a2 2 0 110 4H7a2 2 0 110-4zm0 7a1 1 0 000 2h7a1 1 0 000-2H7zm0-1h7a2 2 0 110 4H7a2 2 0 110-4zM2 9a1 1 0 100-2 1 1 0 000 2zm0 1a2 2 0 110-4 2 2 0 010 4zm0 5a1 1 0 100-2 1 1 0 000 2zm0 1a2 2 0 110-4 2 2 0 010 4z" fill="#FFF" fill-rule="nonzero"></path></svg>'},45:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n(0);t.MIN_WIDGET_HEIGHT=100,t.MIN_WIDGET_WIDTH=100,t.defaultTransitionInfo={transition:{type:o.TransitionType.None,direction:o.TransitionDirection.Horizontal},oneByOneEffect:null},function(e){e.Style0="STYLE0",e.Style1="STYLE1",e.Style2="STYLE2",e.Style3="STYLE3",e.Style4="STYLE4",e.Style5="STYLE5",e.Style6="STYLE6",e.Style7="STYLE7",e.Style8="STYLE8",e.Style9="STYLE9",e.Style10="STYLE10"}(t.ItemStyle||(t.ItemStyle={})),function(e){e.Regular="REGULAR",e.Hover="HOVER"}(t.Status||(t.Status={})),function(e){e.Horizontal="Horizontal",e.Vertical="Vertical"}(t.Direction||(t.Direction={}))},85:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M3.433.822l8 13.856-.866.5L9.31 13H1.5v-3h1v2h6.232L4.114 4H2.5v2h.95l-1.5 2-1.5-2H1.5V3h2.036l-.97-1.678.867-.5zM14.049 8l1.5 2H14.5v3h-3.035l-.576-1H13.5v-2h-.951l1.5-2zm.451-5v3h-1V4H6.268L5.69 3h8.81z" fill="#FFF" fill-rule="evenodd"></path></svg>'},86:function(e,t){e.exports='<svg viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg"><path d="M14.049 8l1.5 2h-1.05v3H1.502v-3H2.5v2h11v-2h-.951l1.5-2zm.451-5v3h-1V4h-11v2h.951l-1.5 2-1.5-2h1.05V3h13z" fill="#FFF" fill-rule="evenodd"></path></svg>'}})}));